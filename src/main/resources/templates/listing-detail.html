<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Listing Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=YOUR_SANDBOX_CLIENT_ID&currency=${session.currency.toUpperCase()}"></script>
</head>
<body>
<div th:replace="fragments/navbar :: navbar"></div>
<div class="container mt-5">
    <div class="card">
        <div class="card-header d-flex justify-content-between">
            <h5 th:text="${listing.material.name}">Material</h5>
            <h5 th:text="${listing.createdBy.name}">Seller</h5>
        </div>
        <div class="card-body">
            <h3 th:text="${listing.material}">Material</h3>
            <p th:text="${listing.description}">Description</p>
            <p><strong>Price:</strong> <span th:text="${listing.price}">10.00</span> <span th:text="${session.currency.toUpperCase()}">USD</span></p>


            <a th:if="${#authentication.name != listing.createdBy.mail or #authentication.authorities.contains('ROLE_ADMIN')}"
               th:href="@{/listing/buy/{id}(id=${listing.id})}"
               class="btn btn-primary" title="Buy Listing">
                Buy Now
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
                    <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
                </svg>
            </a>

            <div id="paypal-button-container" class="mt-3"></div>

            <div th:if="${error}" class="alert alert-danger mt-3" th:text="${error}"></div>
        </div>
    </div>
</div>
<div class="text-center mt-3">
    <button class="btn btn-secondary" onclick="history.back()">Back</button>
</div>

</body>
</html>
